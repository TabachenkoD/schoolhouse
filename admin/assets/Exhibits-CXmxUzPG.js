import{a as A,r as i,j as e,B as D,A as P,u as V,E as k}from"./index-BXjIrL1U.js";import{a as G}from"./apiClient-D5JhjSvK.js";import"./scroll-area-C9u3ILJG.js";import{L as m,I as T,b as y,C as q,a as B,c as M,d as R}from"./label-jx94DjbD.js";import{T as _,a as X,b as N,c as w}from"./tabs-BMRpIXxN.js";import{T as z,S as K,a as W,b as Y,c as J,d as $}from"./textarea-wuKnE0F0.js";import{D as Q,a as Z,b as ee,c as se}from"./dialog-jpzSOnL7.js";import"./Combination-7JF_Quob.js";import"./index-B75h8jgb.js";import"./index-D3oRHOE7.js";import"./check-nXb_93g6.js";const L=({exhibitId:a,isAuthenticated:f,resetExhibit:x,fetchExhibits:b})=>{const{toast:r}=A(),[l,d]=i.useState(""),[h,n]=i.useState(""),[u,s]=i.useState(""),[v,C]=i.useState(""),[F,E]=i.useState(null),[g,I]=i.useState(!1),U=l&&h&&u&&v&&F;i.useEffect(()=>{a?G(`/exhibits/${a}/details`,f).then(t=>{d(t.Title),n(t.Description),s(t.Floors),C(t.Groups),E(null),I(!0)}).catch(t=>{r({variant:"destructive",description:`${t}`})}):S()},[a]);const S=()=>{d(""),n(""),s(""),C(""),E(null),I(!1),typeof x=="function"&&x()},H=async t=>{t.preventDefault();const o=new FormData;o.append("exhibit",l),o.append("description",h),o.append("floor",u),o.append("group",v),o.append("image",F),g&&o.append("id",Number(a));const O=g?"/exhibits/update":"/exhibits";try{const c=await fetch(`${P}${O}`,{method:"POST",body:o,headers:{"X-API-KEY":f}});if(c.ok){const j=c.headers.get("content-type");let p=null;j&&j.includes("application/json")&&(p=await c.json()),r({variant:"success",description:`${g?"Exhibit updated successfully":`Exhibit ${p||""} created successfully`}`}),S(),b()}else{const j=c.headers.get("content-type");let p="An error occurred.";j&&j.includes("application/json")&&(p=(await c.json()).Message),r({variant:"destructive",description:p})}}catch(c){r({variant:"destructive",description:`${c}`})}};return e.jsxs("form",{onSubmit:H,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"title",children:"Title"}),e.jsx(T,{id:"title",type:"text",value:l,onChange:t=>d(t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"description",children:"Description"}),e.jsx(z,{id:"description",value:h,onChange:t=>n(t.target.value)})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"floor",className:"mb-2",children:"Floor"}),e.jsxs(K,{value:u,onValueChange:s,children:[e.jsx(W,{id:"floor",children:e.jsx(Y,{placeholder:"Select floor"})}),e.jsxs(J,{children:[e.jsx($,{value:"First floor",children:"First floor"}),e.jsx($,{value:"Second floor",children:"Second floor"})]})]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"group",children:"Group"}),e.jsx(T,{id:"group",type:"text",value:v,onChange:t=>C(t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"file",children:"Image"}),e.jsx(T,{id:"file",type:"file",accept:"image/*",onChange:t=>E(t.target.files[0]),required:!0})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(D,{type:"reset",variant:"secondary",onClick:S,children:"Reset"}),e.jsx(D,{type:"submit",disabled:!U,children:g?"Update Exhibit":"Create Exhibit"})]})]})},ue=()=>{const{isAuthenticated:a}=V(),{toast:f}=A(),[x,b]=i.useState([]),[r,l]=i.useState(!1),[d,h]=i.useState(null);i.useEffect(()=>{n()},[]);const n=()=>{a&&G("/exhibits",a).then(s=>{b(s)}).catch(s=>{f({variant:"destructive",description:`${s}`})})},u=()=>{h(null),l(!1)};return e.jsxs("div",{className:"overflow-hidden flex flex-row h-full w-full",children:[e.jsxs(_,{defaultValue:"List",className:"w-full",children:[e.jsxs(X,{children:[e.jsx(N,{value:"List",children:"List"}),e.jsx(N,{value:"Create",children:"Create"})]}),e.jsxs(w,{value:"List",children:[e.jsx("div",{className:"p-4",children:e.jsx(y,{className:"mb-4",children:"Exhibits"})}),e.jsx("div",{className:"flex flex-wrap gap-y-4 px-4 gap-x-4",children:x.length===0?e.jsx("p",{children:"No exhibits available"}):x.map(s=>e.jsxs(q,{className:"w-[420px]",children:[e.jsxs(B,{className:"flex-row justify-between items-top",children:[e.jsxs("div",{children:[e.jsx(y,{children:s.Title}),e.jsxs(M,{children:["Exhibit Id: ",s.ExhibitId]})]}),e.jsx(D,{style:{margin:0},variant:"orange",size:"sm",onClick:()=>{h(s.ExhibitId),l(!0)},children:"Update"})]}),e.jsxs(R,{children:[e.jsx("img",{src:`${k}/${s.ExhibitImageName}`,alt:s.Title,style:{maxWidth:"370px"}}),e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",s.Description]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Floor:"})," ",s.Floors]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Group:"})," ",s.Groups]})]})]},s.ExhibitId))})]}),e.jsx(w,{value:"Create",children:e.jsxs("div",{className:"p-4",children:[e.jsx(y,{className:"mb-4",children:"Create exhibit"}),e.jsx("div",{className:"w-1/3",children:e.jsx(L,{isAuthenticated:a,fetchExhibits:n})})]})})]}),r&&e.jsx(Q,{open:r,onOpenChange:l,children:e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsx(se,{children:"Update Exhibit"})}),d?e.jsx(L,{exhibitId:d,isAuthenticated:a,resetExhibit:u,fetchExhibits:n}):e.jsx("p",{children:"Loading..."})]})})]})};export{ue as default};
